<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>2020-07-25-DrupalCon-Global</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/bounteous.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
<style>
code.nohighlight {
  background: #3f3f3f;
  color: #dcdcdc;
}
section img {
  border: none !important;
}
.reveal h1 {
  font-size: 2.5em;
}
.flex-container {
  display: flex;
  flex-flow: row wrap;
  justify-content: space-around;
}
.flex-container > div {
  flex-grow: 2;
  flex: 2 50%;
}

.reveal .slides section mark.fragment:not(.current-fragment):not(.visible) {
  opacity: 1;
  visibility: visible;
  background: none;
  color: inherit;
}
.reveal .slides section mark {
  background: #fff47e;
}
.reveal .slides section mark.alert {
  background: #fe9595;
}
.reveal .slides section mark.visible,
.reveal .slides section mark.visible .hljs-title,
.reveal .slides section mark.visible .hljs-name,
.reveal .slides section mark.visible .hljs-selector-id,
.reveal .slides section mark.visible .hljs-selector-class,
.reveal .slides section mark.visible .hljs-section,
.reveal .slides section mark.visible .hljs-type,
.reveal .slides section mark.visible .hljs-string,
.reveal .slides section mark.visible .hljs-keyword {
  color: #333;
}
</style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

<!--

Outline:

  1. Intro
    a. Who am I
    b. Who are you
    c. Story
    d. Overview
  2. Principles of enterprise configuration management in Drupal
  3. Synchronization Models: Dig into the different models, specifics of implementation and pros/cons
  4. Split Models: Dig into the different models, specifics of implementation and pros/cons
  5. Guidelines for Modeling

-->

        <!-- SECTION 1: Intro -->
        <section>

          <section>
            <h1>Models of Configuration Management</h1>
            <div class="flex-container">
              <div>
                <p>by Joseph D. Purcell</p>
              </div>
              <div>
                <p>at DrupalCon Global</p>
              </div>
              <div>
                <small><a href="https://www.linkedin.com/in/josephdpurcell">@josephdpurcell</a></small>
              </div>
              <div>
                <small>July 15, 2020</small>
              </div>
            </div>
          </section>

          <section>
            <h2>Who am I?</h2>
            <ul>
              <li>PHP developer since 2004</li>
              <li>Lead Architect at Bounteous</li>
            </ul>
            <br/>
            <p>
              <small><i>We're hiring: <a href="https://www.bounteous.com/careers/">bounteous.com/careers</a></i></small>
            </p>
            <aside class="notes">
              <ul>
                <li>its not 2003, it was 2004!</li>
                <li>we're hiring</li>
              </ul>
            </aside>
          </section>

          <section>
            <h2>Who are you?</h2>
            <aside class="notes">
              <ul>
                <li>You architect new Drupal installations</li>
                <li>You are using Drupal multi-site or Acquia Site Factory</li>
                <li>You're ready for some abstract thinking</li>
                <li>If you're not doing multisite or Site Factory this probably won't be very useful</li>
                <li>If you don't get excited about abstract ideas this might not be so fun</li>
              </ul>
            </aside>
          </section>

          <section>
            <h2>Did anyone else do this?</h2>
            <p><code>application/config/mysql_history.sql</code></p>
            <pre><code class="sql">
    -- --------------------------------------------------------
    -- Add simple_id
    -- December 23, 2012

    ALTER TABLE `transactions` ADD `simple_id` VARCHAR(255) AFTER `modified`;
            </code></pre>
            <aside class="notes">
              <ul>
                <li>Maybe you needed a dbadmin to execute the statement</li>
                <li>Maybe those statements had to be communicated weeks in advance, which meant your application had to be forward or backward compatible.</li>
              </ul>
            </aside>
          </section>

          <section>
            <h2>With Config Management we're all dbadmins.</h2>
            <div style="display:block;width:140%;margin-left:-20%;">
            <pre><code class="nohighlight">
  $ drush updb
  ---------------- --------------------------------- --------------- -------------------------------------------------------------------------------
   Module           Update ID                         Type            Description
  ---------------- --------------------------------- --------------- -------------------------------------------------------------------------------
   system           8901                              hook_update_n   Update the stored schema data for entity identifier fields.
   layout_builder   override_entity_form_controller   post-update     Clear caches due to addition of service decorator for entity form controller.
  ---------------- --------------------------------- --------------- -------------------------------------------------------------------------------
  ...

  $ drush cex sync
  Differences of the active config to the export directory:
  +------------+-----------------------------------------------------+-----------+
  | Collection | Config                                              | Operation |
  +------------+-----------------------------------------------------+-----------+
  |            | system.all_the_things                               | Update    |
  |            | layout.all_the_things                               | Update    |
  +------------+-----------------------------------------------------+-----------+
  The .yml files in your export directory (../config/sync) will be deleted and replaced with the active config. (yes/no) [yes]:
  >
            </code></pre>
            </div>
            <aside class="notes">
              <ul>
                <li>We don't even think about it!</li>
                <li>When is the last time you had a dbadmin role on a Drupal project, just to manage schema changes?</li>
                <li>We write update hooks for some things, but the large majority of our development is this</li>
              </ul>
            </aside>
          </section>

          <section>
            <h2>Takeaways:</h2>
            <ol>
              <li class="fragment">There are 4 Config Synchronization models.</li>
              <li class="fragment">There are 4 Config Split models.
                <ul>
                  <li class="fragment">And, there are 5 ways a config entity can be split</li>
                </ul>
              </li>
              <li class="fragment">There are guidelines for how to choose the right model.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h1>Overview</h1>
            <ol style="list-style-type:upper-roman">
              <li>Principles of Config Management</li>
              <li>Config Synchronization Models</li>
              <li>Config Split Models</li>
              <li>Guidelines for Modeling</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>
        </section>

<!--
===============================================================================
               Part I. Principles of Config Management
===============================================================================
-->

        <section>

          <section>
            <h2>I. Principles of Config Management</h2>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 1: Manage your config.</h3>
            <blockquote>
              Always version your database.<br>
              <span class="attribution">&mdash; K. Scott Allen</span>
            </blockquote>
            <p>This means use the config management system, which could be at the site level, install profile level, or core/contrib level.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>


          <section>
            <h4>What is configuration?</h4>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Configuration is...</h4>
            <ul>
              <li>Site configurations (site name, performance settings)</li>
              <li>Schema (content types, fields, etc)</li>
              <li>Plugin configs (payment methods, SOLR)</li>
              <li>Content (page manager, block placement)</li>
            </ul>
            <p class="fragment">... itâ€™s a little squishy.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Why does it need managed??</h4>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>What happens when you don't...</h4>
            <ol>
              <li>Have you ever made schema changes manually on PROD because you didnâ€™t have a good way to script them?</li>
              <li class="fragment">Have you worked with Magento, WordPress, Oro, or pretty much any framework without an automated config manager?</li>
              <li class="fragment">Have you used Drupal 7 features?</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <img src="assets/works-on-my-machine.jpg" />
            <aside class="notes">
              <ul>
                <li>Oh I forgot to tell you some manual steps, you have to run this MySQL command</li>
                <li>Oh, I forgot to write the 5,000 lines of database migration code</li>
                <li>Oh, the feature is not reverting? Did you try a hammer?</li>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Welcome to the future:<br>Drupal Configuration Management</h4>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 2: Always have clean configuration.</h3>
            <p class="fragment">What is clean configuration?</p>
          </section>

          <section>
            <h4>By default, all configuration is managed.</h4>
            <pre><code class="nohighlight">
  $ drush cim sync
  $ drush cex sync
            </code></pre>
            <p class="fragment">But, you can make it unmanaged.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Managed vs Unmanaged Configuration</h4>
            <ul>
              <li><b>Managed:</b> Config that is under version control and deployed, it is imported and exported. (default)</li>
              <li><b>Unmanaged:</b> Config that is treated as state in the database, it is ignored by import/export.</li>
            </ul>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Make configuration unmanaged by...</h4>
            <ol>
              <li class="fragment">Add the config to config ignore (requires config_ignore)</li>
              <li class="fragment">Add the config to config export ignore (requires a custom config split OR just use config_export_ignore)</li>
              <li class="fragment">Add the config to the allow list (if using config_readonly)</li>
              <li class="fragment">Add default configurations to your install profile, as needed (this is tricky!)</li>
              <li class="fragment">Change role permissions to allow editing that config</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Properly managed vs unmanaged settings mean you always have clean configuration.</h4>
            <p>Clean configuration means: The managed configuration in the database exactly matches that in version control.</p>
            <b>GOOD:</b>
            <pre><code class="nohighlight">
  $ drush config-status
   [notice] No differences between DB and sync directory.
            </code></pre>
            <b>BAD:</b>
            <pre><code class="nohighlight">
  $ drush config-status
   ----------------------------------------------------- -----------
    Name                                                  State
   ----------------------------------------------------- -----------
    system.site                                           Different
   ----------------------------------------------------- -----------
            </code></pre>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Config that changes needs to be unmanaged</h4>
            <p>Some examples:</p>
            <ul>
              <li>Block placement (block.block.*)</li>
              <li>Modules that are using config instead of state (key/value), e.g. Acquia's Connector which was recently fixed</li>
              <li>Config you want a site admin to edit live (webform.*, tb_megamenu.menu_config.*)</li>
            </ul>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 3: The default config set is for what is common to all sites.</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>What is the default config set?</h4>
            <p>Simply put, it is:</p>
            <pre><code class="php">
  $settings['config_sync_directory'] = '../config/sync';
            </code></pre>
            <p>There is only 1 per site.</p>
            <p>By default, all config exports to and imports from here.</p>
            <div class="fragment">
              <p>If you're using config set per-profile it might look like this:</p>
              <pre style="width:108%;margin-left:-4%;"><code class="php">
  $settings['config_sync_directory'] = "../docroot/profiles/custom/{$profile_name}/config/sync";
              </code></pre>
            </div>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 4: Split sets of configuration off the default set per use-case.</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>A split configuration set might be...</h4>
            <ul>
              <li>An enviornment (e.g. DEV)</li>
              <li>A site (e.g. in a multisite scenario)</li>
              <li>An install profile</li>
            </ul>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 5: Programmatically disable all splits, then enable.</h3>
            <p>Example: environment splits should be disabled, then enabled:</p>
            <pre><code class="php">
  $config['config_split.config_split.dev']['status'] = FALSE;
  $config['config_split.config_split.stage']['status'] = FALSE;
  $config['config_split.config_split.prod']['status'] = FALSE;
  $config['config_split.config_split.' . $env_name]['status'] = TRUE;
            </code></pre>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 6: Config flows from local to production.</h3>
            <p>Your primary development branch is the canonical source of configuration.</p>
            <p>All changes branch off the canonical and are merged back into it, just like any other code changes.</p>
            <p>This implies you run config import on deploy.</p>
            <p class="fragment">Note: production's database is canonical only for unmanaged config!</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Reset your local config to the canonical before making changes.</h4>
            <p>Consider a "reset" script that is run every time you change branches:</p>
            <ul>
              <li>Run composer install</li>
              <li>Copy canonical database into your local</li>
              <li>Run database updates (drush updb)</li>
              <li>Run config import, twice (drush cim sync)</li>
              <li>Now, you are ready to make changes</li>
            </ul>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Principle 7: Import config twice on deploy</h4>
            <p>Changes to how your config is managed are not reflected until the second import.</p>
            <p>(I've not seen any indication this will change.)</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Principle 8:<br>80% of a default config set should be shared by all sites.</h3>
            <p>Example: 12 content types, 10 are managed, 2 are unmanaged.</p>
            <p>At least 8 should be in your default config set (synchronization directory).</p>
            <p>Math: 8 / (12 - 2) = 80%</p>
            <p>(This proxy guideline for how difficult it will be to manage the application.)</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Principle 9: Managed config does not scale well with number of sites.</h4>
            <div style="text-align:left;display:block">
            <p><b>1 site:</b> &gt; 90% managed config ("Collectible" sites)</p>
            <p><b>2-5 sites:</b> 80% managed config</p>
            <p><b>6-20 sites:</b> 40% managed config</p>
            <p><b>20+ sites:</b> &lt; 20% managed config ("Commodity" sites)</p>
            </div>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h2>Get ready for the main event!</h4>
            <p>Drumroll, please...</p>
            <iframe src="https://giphy.com/embed/uKWE6qMrVOEEg" width="480" height="267" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
            <p><a href="https://giphy.com/gifs/muppets-drummer-drumm-uKWE6qMrVOEEg" style="font-size:80%;">via GIPHY</a></p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Two categories of config models:</h3>
            <ul>
              <li><b>Synchronization Models:</b> for your site's entire set of config.</li>
              <li><b>Split Models:</b> for splitting out differences on a module or config-entity level (e.g. per-environment split of dblog).</li>
            </ul>
            <p class="fragment">Pick 1 synchronization model, layer on split models as you like.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>


        </section>

<!--
===============================================================================
               Part II. Configuration Synchronization Models
===============================================================================
-->

        <section>

          <section>
            <h2>Configuration Synchronization Models</h2>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Config Synchronization Models</h3>
            <ol style="width:110%">
              <li><b>Globally Shared Management (default):</b> All sites share the config set.</li>
              <li><b>Profile Shared Management:</b> All sites of the same profile share the config set.</li>
              <li><b>Separate Management:</b> All sites have their own config set.</li>
              <li><b>Unmanaged:</b> No configurations are managed in code.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Model 1: Globally Shared Management (default)</h4>
            <img src="assets/Config_Management_Model_1__Globally_Shared_Management.png" width="80%" />
            <pre><code class="php">
  $settings['config_sync_directory'] = '../config/sync';
            </code></pre>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Model 2: Profile Shared Management</h4>
            <img src="assets/Config_Management_Model_2__Profile_Shared_Management.png" width="80%" />
            <div style="font-size:80%">
            <pre style=""><code class="php">
  $settings['config_sync_directory'] = "../docroot/profiles/custom/{$profile_name}/config/sync";
            </code></pre>
            <p>This is a symlink to <code>../config/{$profile_name}/sync</code></p>
            </div>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Model 3: Separate Management</h4>
            <img src="assets/Config_Management_Model_3__Separate_Management.png" width="80%" />
            <pre><code class="php">
  $settings['config_sync_directory'] = "../config/{$site_name}/sync";
            </code></pre>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Model 4: Unmanaged</h4>
            <img src="assets/Config_Management_Model_4__Unmanaged.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

        </section>

<!--
===============================================================================
               Part III. Config Split Models
===============================================================================
-->
        <section>

          <section>
            <h3>Config Split Models</h3>
            <ol>
              <li><b>Environment Splits:</b> Allows DEV to have different config than PRD.</li>
              <li><b>Site Splits:</b> Allows sites to have different config than what is in synchronization.</li>
              <li><b>Profile Splits:</b> Allows all sites of a given profile to have different config than what is in synchronization.</li>
              <li><b>Module Splits:</b> Allows sites with a given module to have different config than what is in synchronization.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Let's look at 4 examples...</h4>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>1: Environment Splits with Globally Shared Management</h4>
            <img src="assets/Config_Management_Model_1__Globally_Shared_Management_-_Environment_Splits.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>2: Profile Splits with Globally Shared Management</h4>
            <img src="assets/Config_Management_Model_1__Globally_Shared_Management_-_Profile_Splits.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>3: Site Splits with Globally Shared Management</h4>
            <img src="assets/Config_Management_Model_1__Globally_Shared_Management_-_Site_Splits.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>4: Site Splits with Profile Shared Management</h4>
            <img src="assets/Config_Management_Model_2__Profile_Shared_Management_-_Site_Splits.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <p>You can't talk about config split models without getting into split types...</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>5 ways a config entity can be split.</h3>
            <p>With each of the split examples, on a per-module or per-config entity basis you choose between these options:</p>
            <ol>
              <li><b>No Split (default):</b> The config entity is always in synchronization, it never splits.</li>
              <li><b>Complete Module Split:</b> The module is only enabled when that split is active, and all of its config entities only exist when the split is active.</li>
              <li><b>Complete Entity Split:</b> The entity is never in synchronization, it only exists when the split is active.</li>
              <li><b>Conditional Entity Split:</b> The entity is always in synchronization, it only splits if its different than synchronization.</li>
              <li><b>Unmanaged:</b> The config entity is never in synchronization or splits, it only exists in the database.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Look at examples with Profile Shared Management and Site Splits</h4>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>No Split (default)</h4>
            <img src="assets/Config_Splits__Default.png" width="80%" />
            <p>All config imports and exports to synchronization directory.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Complete Module Split</h4>
            <img src="assets/Config_Splits__Module_complete_split.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Complete Entity Split</h4>
            <img src="assets/Config_Splits__Config_entity_complete_split.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Conditional Entity Split</h4>
            <img src="assets/Config_Splits__Config_entity_conditional_split.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Unmanaged</h4>
            <img src="assets/Config_Splits__Unmanaged_config_entity.png" width="80%" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

        </section>

<!--
===============================================================================
              Part III. Guidelines for Modeling
===============================================================================
-->

        <section>

          <section>
            <h2>III. Guidelines for Modeling</h2>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Which Synchronization Model should you use?</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <img src="assets/Configuration_Management__Synchronization_Models_Comparison.png" />
            <aside class="notes">
              <ul>
                <li>Separate: works well for managing lots of config for a few sites < 10</li>
                <li>Globally shared: works well for managing a few configs for many sites < 20; youll want splits</li>
                <li>Profile Shared: works well for managing a few configs for a lot of sites < 100</li>
                <li>Unmanaged: works well for 1,000s of sites</li>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Which Split Model(s) should you use?</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h4>Synchronization Models and Split Models Work Together</h4>
            <table>
              <thead>
                <tr>
                  <th>&nbsp;</th>
                  <th>Env Splits</th>
                  <th>Site Splits</th>
                  <th>Profile Splits</th>
                  <th>Module Splits</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Globally Shared</td>
                  <td>âœ…</td>
                  <td>âœ…</td>
                  <td>âœ…</td>
                  <td>âœ…</td>
                </tr>
                <tr>
                  <td>Profile Shared</td>
                  <td>âœ…</td>
                  <td>âœ…</td>
                  <td>ðŸš«</td>
                  <td>âœ…</td>
                </tr>
                <tr>
                  <td>Separate</td>
                  <td>âœ…</td>
                  <td>ðŸš«</td>
                  <td>âœ…</td>
                  <td>âœ…</td>
                </tr>
                <tr>
                  <td>Unmanaged</td>
                  <td>ðŸš«</td>
                  <td>ðŸš«</td>
                  <td>ðŸš«</td>
                  <td>ðŸš«</td>
                </tr>
              </tbody>
            </table>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <table style="width:120%;margin-left:-10%;">
              <thead>
                <tr>
                  <th>Scenario</th>
                  <th>Use Case</th>
                  <th># Sites</th>
                  <th>% Managed</th>
                </tr>
              </thead>
              <tbody>
                <tr class="fragment">
                  <td>Globally Shared with Site Splits</td>
                  <td>Same functionality, minor per-site differences</td>
                  <td>&lt;10</td>
                  <td>100%</td>
                </tr>
                <tr class="fragment">
                  <td>Globally Shared with Profile Splits</td>
                  <td>Same functionality, minor per-install-profile differences</td>
                  <td>20+</td>
                  <td>80%</td>
                </tr>
                <tr class="fragment">
                  <td>Profile Shared with Site Splits</td>
                  <td>Same functionality by install profile, minor per-site differences</td>
                  <td>20+</td>
                  <td>80%</td>
                </tr>
                <tr class="fragment">
                  <td>Unmanaged</td>
                  <td>Same base functionality, large differences per-site</td>
                  <td>70+</td>
                  <td>0%</td>
                </tr>
              </tbody>
            </table>
            <p class="fragment">Environment splits and module splits can be used with any managed setup.</p>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>How do you choose whether to make a config managed, unmanaged, or split?</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <img src="assets/Config_Splits__Decision_Tree_for_Managed__Splits__and_Unmanaged_Config.png" style="width:90%;margin-top:-4%;" />
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

        </section>

<!--
===============================================================================
                               Conclusion
===============================================================================
-->

        <section>

          <section>
            <h2>Recap</h2>
          </section>

          <section>
            <h3>4 Config Synchronization Models</h3>
            <ol>
              <li>Globally Shared Management (default): All sites share the config set.</li>
              <li>Profile Shared Management: All sites of the same profile share the config set.</li>
              <li>Separate Management: All sites have their own config set.</li>
              <li>Unmanaged: No configurations are managed in code.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>4 Config Split Models</h3>
            <ol>
              <li>Environment Splits: Allows DEV to have different config than PRD.</li>
              <li>Site Splits: Allows sites to have different config than what is in synchronization.</li>
              <li>Profile Splits: Allows all sites of a given profile to have different config than what is in synchronization.</li>
              <li>Module Splits: Allows sites with a given module to have different config than what is in synchronization.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>5 ways a config entity can be split.</h3>
            <p>With each of the split examples, on a per-module or per-config entity basis you choose between these options:</p>
            <ol>
              <li><b>No Split (default):</b> The config entity is always in synchronization, it never splits. (default)</li>
              <li><b>Complete Module Split:</b> The module is only enabled when that split is active, and all of its config entities only exist when the split is active.</li>
              <li><b>Complete Entity Split:</b> The entity is never in synchronization, it only exists when the split is active.</li>
              <li><b>Conditional Entity Split:</b> The entity is always in synchronization, it only splits if its different than synchronization.</li>
              <li><b>Unmanaged:</b> The config entity is never in synchronization or splits, it only exists in the database.</li>
            </ol>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

          <section>
            <h3>Refer back to our decision aids...</h3>
            <aside class="notes">
              <ul>
              </ul>
            </aside>
          </section>

        </section>

<!--
===============================================================================
                          Thank You!
===============================================================================
-->

        <section>

          <section>
            <h2>Thank you!</h2>
            <p>Please provide feedback:<br><a href="https://events.drupal.org/global2020/sessions/models-configuration-management">events.drupal.org/global2020/sessions/models-configuration-management</a></p>
            <br/>
            <p>Slides are available:<br><a href="https://github.com/josephdpurcell/drupal-models-for-configuration-management">github.com/josephdpurcell</a></p>
            <p>Let's talk! <a href="https://www.linkedin.com/in/josephdpurcell/">@josephdpurcell</a></p>
          </section>

<!--
          <section>
            <h3>References</h3>

            <ul style="font-size:80%">
            </ul>

            <aside class="notes">
            </aside>
          </section>

          <section>
            <h3>Further Reading</h3>
            https://www.drupal.org/project/config_split/issues/2962511#comment-12595892 - explains why cim twice
            handbook on deploys https://docs.google.com/document/d/1WpJFWbYvfgco-QpyOz8F8wNvN4uelvsIKgEWA-XyZW0/edit#heading=h.40gi5ln6lblb
            my auto deploy blogs


            <ul style="font-size:80%">
            </ul>

            <aside class="notes">
            </aside>
          </section>
-->

        </section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
      });
    </script>
    <aside class="logo-footer">
      <a href="https://www.bounteous.com/">
        <img src="assets/bounteous.svg">
      </a>
    </aside>
  </body>
</html>
